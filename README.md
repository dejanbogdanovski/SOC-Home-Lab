SOC Home Lab: Threat Detection & Analysis with Splunk & SysmonProject OverviewThis project involved the creation of a comprehensive SOC Home Lab environment built with Oracle VirtualBox. The primary objective was to simulate a real-world attack vector and gain hands-on experience in threat detection engineering by using Sysmon for granular endpoint monitoring and Splunk SIEM for continuous log analysis and adversary activity mapping.Technical StackHypervisor: Oracle VirtualBox.Victim Machine: Windows 10.Attacker Machine: Kali Linux.Security Tools: Splunk Enterprise, Sysmon.Attack Tools: Metasploit Framework (msfvenom/msfconsole).Lab Architecture & WorkflowEnvironment Setup: Provisioned an isolated NAT network ($10.0.2.0/24$) to safely simulate malware execution without risking the host network.Telemetry Configuration: Installed and configured Sysmon on the Windows 10 target to capture advanced system events and forwarded these logs to a central Splunk instance.Adversary Simulation: * Generated a custom reverse shell payload (Resume.pdf.exe) on Kali Linux using msfvenom.Hosted the payload via a Python HTTP server.Executed the payload on the victim machine to establish a Command & Control (C2) connection.Log Analysis: Utilized Splunk's Search Processing Language (SPL) to hunt for indicators of compromise (IoCs).Key Results & EvidenceThe lab successfully demonstrated the visibility gap filled by Sysmon and Splunk.Process Identification: Identified the malicious Resume.pdf.exe process active in the system memory.Log Correlation (Event ID 15): Successfully captured Sysmon Event ID 15 (FileCreateStreamHash), which provided the original source URL of the download and unique file hashes (MD5/SHA256) for forensic analysis.
